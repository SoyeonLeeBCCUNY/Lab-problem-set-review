---
title: "Lab6 comparisons"
author: "Soyeon Lee"
date: "3/29/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tibble)
library(tidyr)
library(dplyr)
options(dplyr.summarise.inform=FALSE)

smith_example<-tribble(
  ~same, ~different, ~imagery, ~photo, ~placebo,
  25,11,14,25,8,
  26,21,15,15,20,
  17,9,29,23,10,
  15,6,10,21,7,
  14,7,12,18,15,
  17,14,22,24,7,
  14,12,14,14,1,
  20,4,20,27,17,
  11,7,22,12,11,
  21,19,12,11,4
)%>%
  pivot_longer(cols=everything(),
               names_to="IV",
               values_to="DV")%>%
  mutate(IV=factor(IV, levels=c("same",
                                "different",
                                "imagery",
                                "photo",
                                "placebo")))

aov.out<-aov(DV~IV, data=smith_example)
summary(aov.out)

contrasts(smith_example$IV)

c1<-c(2,-3,2,2,-3)
c2<-c(2,0,-1,-1,0)S
c3<-c(0,0,+1,-1,0)
c4<-c(0,+1,0,0,-1)

my_contrasts<-cbind(c1,c2,c3,c4)

contrasts(smith_example$IV)<-my_contrasts

aov.out<-aov(DV~IV, data=smith_example)
full_summary<-summary.aov(aov.out,
                          split=list(IV=list("(1+3+4) vs (2+5)"=1,
                                             "(1) vs (3+4)"=2,
                                             "(3) vs (4)"=3,
                                             "(2) vs (5)"=4)))

full_summary
```
```{r}
library(papaja)
apa_table(apa_print(full_summary)$table)

full_summary[[1]]$'F value'[1]
mean(full_summary[[1]]$'F value'[2:5])
```

```{r}
group_means<-c(4,3,10,11)
(grand_mean<-mean(group_means))
(differences<-group_means-grand_mean)
(squared_differences<-differences^2)
(sum_squares<-sum(squared_differences))
```
```{r}
fake_data<-tibble(IV=factor(c("A","B","C","D")),
                  DV=c(4,3,10,11))

contrasts(fake_data$IV)
```



