---
title: "Lab6 comparisons"
author: "Soyeon Lee"
date: "3/29/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tibble)
library(tidyr)
library(dplyr)
options(dplyr.summarise.inform=FALSE)

smith_example<-tribble(
  ~same, ~different, ~imagery, ~photo, ~placebo,
  25,11,14,25,8,
  26,21,15,15,20,
  17,9,29,23,10,
  15,6,10,21,7,
  14,7,12,18,15,
  17,14,22,24,7,
  14,12,14,14,1,
  20,4,20,27,17,
  11,7,22,12,11,
  21,19,12,11,4
)%>%
  pivot_longer(cols=everything(),
               names_to="IV",
               values_to="DV")%>%
  mutate(IV=factor(IV, levels=c("same",
                                "different",
                                "imagery",
                                "photo",
                                "placebo")))

aov.out<-aov(DV~IV, data=smith_example)
summary(aov.out)

contrasts(smith_example$IV)

c1<-c(2,-3,2,2,-3)
c2<-c(2,0,-1,-1,0)S
c3<-c(0,0,+1,-1,0)
c4<-c(0,+1,0,0,-1)

my_contrasts<-cbind(c1,c2,c3,c4)

contrasts(smith_example$IV)<-my_contrasts

aov.out<-aov(DV~IV, data=smith_example)
full_summary<-summary.aov(aov.out,
                          split=list(IV=list("(1+3+4) vs (2+5)"=1,
                                             "(1) vs (3+4)"=2,
                                             "(3) vs (4)"=3,
                                             "(2) vs (5)"=4)))

full_summary
```
```{r}
library(papaja)
apa_table(apa_print(full_summary)$table)

full_summary[[1]]$'F value'[1]
mean(full_summary[[1]]$'F value'[2:5])
```

```{r}
group_means<-c(4,3,10,11)
(grand_mean<-mean(group_means))
(differences<-group_means-grand_mean)
(squared_differences<-differences^2)
(sum_squares<-sum(squared_differences))
```
```{r}
library(tibble)
fake_data<-tibble(IV=factor(c("A","B","C","D")),
                  DV=c(4,3,10,11))

contrasts(fake_data$IV)
```
```{r}
contrasts(fake_data$IV)[,'D']

contrasts(fake_data$IV)[,'D']*differences

grand_mean + (1*differences [4])
```
```{r}
(differences)

contrast_diff<-contrasts(fake_data$IV)* differences

contrast_gmean<-grand_mean *contrasts(fake_data$IV)

contrast_diff +contrast_gmean
```

```{r}
c1<-c(-1,-1,1,1)
c2<-c(1,-1,0,0)
c3<-c(0,0,-1,1)

my_contrasts<-cbind(c1,c2,c3)

contrasts(fake_data$IV)<-my_contrasts
contrasts(fake_data$IV)

cor(contrasts(fake_data$IV))
cor(my_contrasts)
```

```{r}
contrasts(fake_data$IV)

CaMa<-group_means * contrasts(fake_data$IV)
numerator<-1*(colSums(CaMa))^2
numerator/colSums(contrasts(fake_data$IV)^2)

```

```{r}
(fake_data$DV)

(grand_means<-c(7,7,7,7))

grand_means + contrasts(fake_data$IV)[,1]*3

grand_means +
  contrasts(fake_data$IV)[,1]*1 +
  contrasts(fake_data$IV)[,2]*1 +
  contrasts(fake_data$IV)[,3]*1
```
```{r}
fake_data2<-cbind(fake_data, contrasts(fake_data$IV))
fake_data2
lm(DV~c1+c2+c3,data=fake_data2)
summary(lm(DV~c1+c2+c3,data=fake_data2))
```

```{r}
grand_means+
  contrasts(fake_data$IV)[,1]*3.5+
  contrasts(fake_data$IV)[,2]*.5+
  contrasts(fake_data$IV)[,3]*.5
```

```{r}
fake_data<-tibble(IV=factor(c("A","B","C","D")),
                  DV=c(43,22,52,104))

contrasts(fake_data$IV)

c1<-c(-1,-1,1,1)
c2<-c(1,-1,0,0)
c3<-c(0,0,-1,1)
my_contrasts<-cbind(c1,c2,c3)

contrasts(fake_data$IV)<-my_contrasts

fake_data2<-cbind(fake_data,contrasts(fake_data$IV))

(lm(DV~c1+c2+c3,data=fake_data2))
summary(lm(DV~c1+c2+c3,data=fake_data2))

grand_means<-rep(mean(fake_data$DV),4)
grand_means

grand_means +
  contrasts(fake_data$IV)[,1]*22.75+
  contrasts(fake_data$IV)[,2]*10.5+
  contrasts(fake_data$IV)[,3]*26.00
```

